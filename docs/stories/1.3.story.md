# Story 1.3: Build Employee Management Frontend Interface

**Epic:** Employee Master Data Foundation
**Story ID:** 1.3
**Status:** Completed
**Created:** 2025-09-30
**Estimated Effort:** 8-10 hours

## User Story

Sebagai HRD manager PT Kimia Farma,
Saya ingin antarmuka web yang lengkap untuk mengelola data karyawan,
Sehingga saya dapat dengan mudah melihat, mencari, menambah, mengubah, dan mengelola informasi karyawan melalui browser.

## Story Description

**FRONTEND ONLY** - Story ini membangun antarmuka pengguna React lengkap untuk Employee Management system yang mengkonsumsi API endpoints dari Story 1.2. Interface ini menyediakan employee directory, employee detail views, create/edit forms, dan search/filter capabilities menggunakan established patterns: React 18.3 + TypeScript + TanStack Query + Radix UI + TailwindCSS.

**Scope:** This story focuses EXCLUSIVELY on frontend UI implementation. Backend API sudah tersedia dari Story 1.2.

**Catatan Teknis:**

- Semua kode (components, variables, function names) ditulis dalam Bahasa Inggris mengikuti standar TypeScript/React
- Semua label dan text user-facing ditulis dalam Bahasa Indonesia
- Follow existing UI patterns dari user management module

## Acceptance Criteria

### AC1: Employee Directory/List View

- **Given** HRD manager mengakses halaman employee management
- **When** halaman dimuat
- **Then** sistem menampilkan:
  - Daftar karyawan dalam format table dengan pagination
  - Kolom: Foto, Nomor Karyawan, Nama Lengkap, Email, Divisi, Jabatan, Status
  - Pagination controls (previous, next, page numbers)
  - Records per page selector (10, 25, 50, 100)
  - Loading state saat fetch data
  - Empty state dengan pesan jika tidak ada data
  - Error state dengan pesan jika API gagal

### AC2: Search dan Filter Functionality

- **Given** employee list ditampilkan
- **When** HRD manager menggunakan search atau filter
- **Then** sistem menyediakan:
  - Search box untuk cari berdasarkan nama atau nomor karyawan
  - Filter dropdown untuk: Status Kepegawaian, Divisi, Jabatan
  - Filter reset button
  - Real-time search dengan debounce (500ms)
  - Loading indicator saat filtering
  - Filter state persistence dalam URL query parameters

### AC3: Employee Detail View

- **Given** HRD manager klik pada employee dari list
- **When** detail page dibuka
- **Then** sistem menampilkan:
  - Employee photo dan informasi dasar (nama, nomor, email, telepon)
  - Tabbed interface untuk: Info Pribadi, Info Pekerjaan, Pendidikan, Sertifikasi, Lisensi
  - Semua data employee termasuk manager hierarchy
  - Edit button (jika user memiliki permission)
  - Back to list navigation
  - Loading state untuk data fetch
  - 404 page jika employee tidak ditemukan

### AC4: Create Employee Form

- **Given** HRD manager dengan permission yang sesuai
- **When** klik "Tambah Karyawan Baru" button
- **Then** sistem menampilkan:
  - Multi-step form atau long form dengan sections
  - Fields untuk semua required employee data
  - Validation inline dengan error messages bahasa Indonesia
  - Division dan Job Position selector dropdowns
  - Photo upload with preview
  - NIK dan NPWP validation (16 dan 15 digit)
  - Cancel dan Submit buttons
  - Loading state saat submit
  - Success notification dan redirect ke detail page
  - Error handling dengan user-friendly messages

### AC5: Edit Employee Form

- **Given** HRD manager dengan permission edit
- **When** klik Edit button pada employee detail
- **Then** sistem menampilkan:
  - Pre-filled form dengan data existing employee
  - Same validation rules seperti create form
  - Partial update support (hanya field yang diubah)
  - Optimistic updates dengan TanStack Query
  - Success notification setelah save
  - Error handling dan rollback jika gagal
  - Cancel button kembali ke detail view

### AC6: Delete/Deactivate Employee

- **Given** HRD manager dengan delete permission
- **When** pilih delete action untuk employee
- **Then** sistem melakukan:
  - Confirmation dialog dengan warning message
  - Validasi bahwa employee bukan manager aktif
  - Soft delete via API call
  - Success notification
  - Redirect ke employee list
  - Error message jika employee masih memiliki bawahan

### AC7: Responsive Design dan Accessibility

- **Given** kebutuhan untuk akses dari berbagai devices
- **When** aplikasi diakses
- **Then** sistem menyediakan:
  - Responsive layout untuk desktop, tablet, mobile
  - Proper ARIA labels untuk screen readers
  - Keyboard navigation support
  - Focus management untuk modals dan dialogs
  - Loading states yang accessible
  - Error messages yang descriptive

### AC8: Integration dengan Existing UI System

- **Given** existing HRIS UI patterns dan components
- **When** employee module dibangun
- **Then** sistem menggunakan:
  - Existing layout dan navigation structure
  - Shared UI components dari Radix UI library
  - TailwindCSS utility classes sesuai design system
  - Existing authentication dan permission checks
  - Consistent styling dengan existing modules
  - Existing routing patterns

## Dev Notes

### Previous Story Insights

Story 1.2 berhasil membuat backend API endpoints lengkap. Key insights:

- API endpoints tersedia di `/api/employees` dengan full CRUD operations
- Authentication menggunakan Bearer token dari Sanctum
- Response format menggunakan Laravel API Resources dengan struktur consistent
- Validation errors dalam bahasa Indonesia
- Pagination menggunakan Laravel standard format
- Filter dan search support via query parameters

### Frontend Architecture dan Patterns

**React Module Structure** [Source: docs/architecture.md#Source-Tree]

```
resources/app/employee/
├── components/          # Reusable employee-specific components
│   ├── EmployeeList.tsx
│   ├── EmployeeDetail.tsx
│   ├── EmployeeForm.tsx
│   ├── EmployeeSearch.tsx
│   └── EmployeeFilters.tsx
├── pages/              # Route-level page components
│   ├── EmployeeIndex.tsx
│   ├── EmployeeCreate.tsx
│   └── EmployeeEdit.tsx
├── hooks/              # Custom React hooks
│   ├── useEmployees.ts
│   ├── useEmployeeSearch.ts
│   └── useEmployeeMutations.ts
└── types/              # TypeScript type definitions
    └── employee.ts
```

**Existing Pattern Example** [Source: resources/app/user/main/pages/root.tsx]

- TanStack Query untuk data fetching dan caching
- useRecord hook untuk pagination dan filtering
- RecordTable component untuk data tables
- ConfirmDialog untuk delete confirmations
- Alert toast untuk notifications
- Radix UI components untuk UI primitives

### Technology Stack

**Frontend Stack** [Source: docs/architecture.md#Tech-Stack]

- React 18.3.1 dengan TypeScript 5.3.3
- TanStack Query 5.59.8 untuk server state management
- React Router untuk routing
- Radix UI untuk accessible components
- TailwindCSS 3.4.13 untuk styling
- Vite 5.4.8 untuk build tooling

**Component Libraries Available** [Source: existing codebase]

- @radix-ui/react-\* components (Dialog, Dropdown, Select, etc.)
- @tabler/icons-react untuk icons
- Shared components di @src/components/
- Shared UI primitives di @src/ui/

### API Integration Details

**Employee API Endpoints** [Source: Story 1.2]

```
GET    /api/employees              # List dengan pagination, filter, search
GET    /api/employees/{id}         # Detail employee lengkap
POST   /api/employees              # Create new employee
PUT    /api/employees/{id}         # Update employee
DELETE /api/employees/{id}         # Soft delete employee
GET    /api/employees/{id}/pendidikan
GET    /api/employees/{id}/sertifikasi
GET    /api/employees/{id}/lisensi
```

**API Response Format** [Source: Story 1.2 Dev Notes]

```typescript
{
  status: "success" | "error",
  message: string,  // Bahasa Indonesia
  data: EmployeeData | EmployeeData[],
  meta: {
    current_page: number,
    per_page: number,
    total: number,
    last_page: number
  },
  errors?: Record<string, string[]>  // Validation errors
}
```

**Employee TypeScript Type** [Source: Story 1.2 Employee Model]

```typescript
interface Employee {
  id: number;
  nomor_karyawan: string;
  nama_lengkap: string;
  nama_panggilan: string | null;
  email: string;
  telepon: string;
  nik: string;
  npwp: string | null;
  tanggal_lahir: string; // YYYY-MM-DD
  tanggal_masuk: string;
  tanggal_keluar: string | null;
  status_kepegawaian:
    | "active"
    | "inactive"
    | "terminated"
    | "on_leave"
    | "probation"
    | "contract"
    | "suspended";
  jenis_kepegawaian: "permanent" | "contract" | "intern" | "consultant";
  alamat: string | null;
  foto_url: string | null;
  divisi: {
    id: number;
    nama: string;
    kode: string;
  };
  jabatan: {
    id: number;
    nama: string;
    level: number;
  };
  manager: {
    id: number;
    nama_lengkap: string;
    nomor_karyawan: string;
  } | null;
}
```

### TanStack Query Integration

**Query Key Pattern** [Source: existing user module pattern]

```typescript
const employeeKeys = {
  all: ["employees"] as const,
  lists: () => [...employeeKeys.all, "list"] as const,
  list: (filters: EmployeeFilters) =>
    [...employeeKeys.lists(), filters] as const,
  details: () => [...employeeKeys.all, "detail"] as const,
  detail: (id: number) => [...employeeKeys.details(), id] as const,
};
```

**Custom Hooks Pattern** [Source: existing patterns]

- `useEmployees()` - List employees dengan pagination
- `useEmployee(id)` - Single employee detail
- `useCreateEmployee()` - Mutation untuk create
- `useUpdateEmployee()` - Mutation untuk update
- `useDeleteEmployee()` - Mutation untuk delete

### Form Validation

**Client-Side Validation** [Source: docs/architecture.md#Security]

- NIK: 16 digit angka
- NPWP: 15 digit angka (optional)
- Email: valid email format
- Tanggal lahir: tidak boleh di masa depan
- Nomor karyawan: generated by API atau manual input
- All Indonesian format validations matching backend

**Validation Libraries** [Source: existing patterns]

- Zod untuk schema validation
- React Hook Form untuk form state management
- Custom validators di @src/lib/validators

### UI/UX Requirements

**Loading States** [Source: existing UI patterns]

- Skeleton loaders untuk table dan cards
- Spinner untuk buttons saat submit
- LoadingFallback component untuk page loading
- Optimistic updates untuk better UX

**Error Handling** [Source: existing patterns]

- Alert toast untuk success/error notifications
- Inline field errors untuk validation
- Error boundary untuk component crashes
- 404 page untuk not found employees

**Accessibility** [Source: docs/architecture.md#Coding-Standards]

- Proper ARIA labels dan roles
- Keyboard navigation support
- Focus management untuk modals
- Screen reader friendly error messages
- Color contrast compliance

### Routing Structure

**Routes to Implement** [Source: existing routing pattern]

```
/employees              # Employee list/directory
/employees/new          # Create new employee
/employees/:id          # Employee detail view
/employees/:id/edit     # Edit employee form
```

### Testing Requirements

**Component Testing** [Source: docs/architecture.md#Test-Strategy]

- Test employee list rendering
- Test search dan filter functionality
- Test form validation
- Test API integration dengan MSW mocks
- Test loading dan error states
- Test user interactions

**Testing Tools** [Source: docs/architecture.md#Tech-Stack]

- Vitest untuk unit testing
- Testing Library untuk component testing
- MSW (Mock Service Worker) untuk API mocking
- 40% minimum coverage untuk React components

### Security dan Authorization

**Permission Checks** [Source: existing auth patterns]

- `useAuth()` hook untuk current user context
- `usePermissions()` hook untuk permission checks
- Conditional rendering berdasarkan permissions
- Permission levels: hr_admin, hr_staff, manager

**RBAC Integration** [Source: docs/architecture.md#Security]

- hr_admin: full access (create, edit, delete)
- hr_staff: read dan update only
- manager: read own team only

### Integration Points

**Existing Components to Reuse** [Source: @src/components/]

- SelectDivision - Division dropdown selector
- SelectJobPosition - Job position selector
- RecordTable - Data table with sorting/pagination
- RecordPagination - Pagination controls
- SearchBox - Search input component
- ConfirmDialog - Confirmation dialogs
- LoadingFallback - Loading states

**Shared UI Components** [Source: @src/ui/]

- Button, ButtonLink
- Avatar, AvatarImage, AvatarFallback
- Dialog, DropdownMenu
- Form components (Input, Select, Label, etc.)
- Table components
- Alert toast

## Tasks / Subtasks

### Task 1: Setup Module Structure dan Types (AC: 8)

1.1. Create folder structure: `resources/app/employee/` dengan subdirectories
1.2. Create TypeScript types file `employee.ts` dengan Employee interface
1.3. Create API response types dan filter types
1.4. Setup barrel exports untuk clean imports
1.5. Create query key factory untuk TanStack Query
1.6. Setup routing configuration untuk employee module

### Task 2: Implement TanStack Query Hooks (AC: 1, 2, 3, 8)

2.1. Create `useEmployees` hook untuk list dengan pagination dan filtering
2.2. Create `useEmployee(id)` hook untuk single employee detail
2.3. Create `useCreateEmployee` mutation hook
2.4. Create `useUpdateEmployee` mutation hook
2.5. Create `useDeleteEmployee` mutation hook
2.6. Implement proper cache invalidation strategies
2.7. Add optimistic updates untuk mutations
2.8. Add error handling dan retry logic

### Task 3: Build Employee List Component (AC: 1, 2)

3.1. Create `EmployeeList.tsx` component menggunakan RecordTable
3.2. Implement table columns dengan proper TypeScript types
3.3. Add employee photo column dengan Avatar component
3.4. Implement sorting functionality pada columns
3.5. Add action column dengan edit/delete dropdown menu
3.6. Implement loading skeleton untuk table
3.7. Add empty state component
3.8. Add error state handling

### Task 4: Build Search dan Filter Components (AC: 2)

4.1. Create `EmployeeSearch.tsx` dengan debounced search input
4.2. Create `EmployeeFilters.tsx` dengan filter dropdowns
4.3. Implement filter untuk Status Kepegawaian
4.4. Implement filter untuk Divisi menggunakan SelectDivision
4.5. Implement filter untuk Jabatan menggunakan SelectJobPosition
4.6. Add filter reset functionality
4.7. Sync filters dengan URL query parameters
4.8. Add filter loading states

### Task 5: Create Employee Index Page (AC: 1, 2, 8)

5.1. Create `pages/EmployeeIndex.tsx` sebagai main page
5.2. Integrate EmployeeList, Search, dan Filter components
5.3. Add "Tambah Karyawan Baru" button dengan permission check
5.4. Implement pagination controls
5.5. Add records per page selector
5.6. Implement page header dengan title dan breadcrumbs
5.7. Add loading fallback untuk page level
5.8. Connect dengan useEmployees hook

### Task 6: Build Employee Detail Component (AC: 3)

6.1. Create `EmployeeDetail.tsx` component
6.2. Implement tabbed interface untuk Info sections
6.3. Create tab untuk Informasi Pribadi
6.4. Create tab untuk Informasi Pekerjaan
6.5. Create tab untuk Pendidikan dengan child data
6.6. Create tab untuk Sertifikasi dengan child data
6.7. Create tab untuk Lisensi Profesional dengan child data
6.8. Add manager hierarchy display
6.9. Implement edit button dengan permission check
6.10. Add loading skeleton untuk detail view

### Task 7: Create Employee Detail Page (AC: 3, 8)

7.1. Create `pages/EmployeeEdit.tsx` untuk detail view route
7.2. Integrate EmployeeDetail component
7.3. Implement back to list navigation
7.4. Add 404 handling untuk invalid employee ID
7.5. Connect dengan useEmployee(id) hook
7.6. Add page header dengan employee name
7.7. Implement loading state untuk page

### Task 8: Build Employee Form Component (AC: 4, 5)

8.1. Create `EmployeeForm.tsx` component dengan React Hook Form
8.2. Implement Zod schema untuk validation
8.3. Add form sections: Informasi Pribadi, Kontak, Pekerjaan
8.4. Implement photo upload dengan preview
8.5. Add NIK validation (16 digit) dengan error message Indonesia
8.6. Add NPWP validation (15 digit) dengan error message Indonesia
8.7. Implement Division selector dengan SelectDivision component
8.8. Implement Job Position selector dengan SelectJobPosition component
8.9. Add date pickers untuk tanggal lahir dan tanggal masuk
8.10. Implement form submission dengan loading state
8.11. Add cancel button dengan unsaved changes warning
8.12. Display API validation errors inline

### Task 9: Create New Employee Page (AC: 4, 8)

9.1. Create `pages/EmployeeCreate.tsx` untuk create route
9.2. Integrate EmployeeForm component dalam create mode
9.3. Connect dengan useCreateEmployee mutation hook
9.4. Implement success notification
9.5. Add redirect ke detail page setelah create
9.6. Implement error handling
9.7. Add page header "Tambah Karyawan Baru"

### Task 10: Create Edit Employee Page (AC: 5, 8)

10.1. Create `pages/EmployeeEdit.tsx` untuk edit route
10.2. Integrate EmployeeForm component dalam edit mode
10.3. Pre-fill form dengan existing employee data
10.4. Connect dengan useUpdateEmployee mutation hook
10.5. Implement optimistic updates
10.6. Add success notification
10.7. Handle API errors dengan rollback
10.8. Redirect ke detail view setelah save

### Task 11: Implement Delete Functionality (AC: 6)

11.1. Add delete action dalam employee list dropdown menu
11.2. Implement ConfirmDialog untuk delete confirmation
11.3. Add warning message dalam confirmation dialog
11.4. Connect dengan useDeleteEmployee mutation hook
11.5. Implement cache invalidation setelah delete
11.6. Add success notification
11.7. Handle error untuk employee dengan bawahan aktif
11.8. Redirect ke list page setelah delete

### Task 12: Responsive Design Implementation (AC: 7)

12.1. Test layout pada desktop viewport (1280px+)
12.2. Test layout pada tablet viewport (768px-1279px)
12.3. Test layout pada mobile viewport (<768px)
12.4. Adjust table untuk mobile dengan card layout alternative
12.5. Ensure form fields responsive pada semua devices
12.6. Test navigation dan modals pada mobile
12.7. Verify touch interactions pada mobile devices

### Task 13: Accessibility Implementation (AC: 7)

13.1. Add ARIA labels untuk semua interactive elements
13.2. Implement keyboard navigation untuk table
13.3. Add focus management untuk modals dan dialogs
13.4. Test dengan screen reader (NVDA atau JAWS)
13.5. Ensure proper heading hierarchy (h1, h2, h3)
13.6. Add skip links untuk main content
13.7. Verify color contrast ratios untuk text
13.8. Test keyboard-only navigation flow

### Task 14: Component Testing (AC: All)

14.1. Write tests untuk EmployeeList component
14.2. Write tests untuk EmployeeSearch dengan debounce
14.3. Write tests untuk EmployeeFilters functionality
14.4. Write tests untuk EmployeeForm validation
14.5. Write tests untuk TanStack Query hooks dengan MSW
14.6. Test loading states untuk all components
14.7. Test error states dan error handling
14.8. Test user interactions dan form submissions
14.9. Achieve 40% minimum test coverage

### Task 15: Integration dan Polish (AC: 8)

15.1. Integrate employee module dengan main navigation
15.2. Add employee module ke routing configuration
15.3. Verify authentication flow integration
15.4. Test permission-based rendering
15.5. Polish loading states dan transitions
15.6. Review dan fix any UI inconsistencies
15.7. Performance optimization (code splitting, lazy loading)
15.8. Final testing across all acceptance criteria

## Definition of Done

### Functional Requirements Complete

- ✅ Employee list page menampilkan semua employees dengan pagination
- ✅ Search dan filter functionality berfungsi dengan baik
- ✅ Employee detail page menampilkan data lengkap dengan tabs
- ✅ Create employee form dapat menambah karyawan baru
- ✅ Edit employee form dapat mengubah data existing
- ✅ Delete functionality dengan confirmation bekerja
- ✅ Semua validations client-side matching backend
- ✅ Error handling comprehensive dengan user-friendly messages

### Quality Requirements Met

- ✅ Component tests achieve 40% minimum coverage
- ✅ All components follow TypeScript strict mode
- ✅ No ESLint errors atau warnings
- ✅ Prettier formatting applied consistently
- ✅ Loading states implemented untuk all async operations
- ✅ Error states implemented dengan proper messaging
- ✅ No console errors atau warnings dalam browser

### UI/UX Requirements Satisfied

- ✅ Responsive design works pada desktop, tablet, mobile
- ✅ Accessibility requirements met (ARIA labels, keyboard nav)
- ✅ Consistent styling dengan existing modules
- ✅ Smooth transitions dan loading indicators
- ✅ Indonesian language untuk all user-facing text
- ✅ Intuitive navigation dan user flow
- ✅ Professional appearance matching PT Kimia Farma branding

### Integration Requirements Met

- ✅ TanStack Query integration dengan proper caching
- ✅ API integration dengan Story 1.2 backend working
- ✅ Authentication dan authorization integrated
- ✅ Routing integrated dengan main application
- ✅ Shared components reused properly
- ✅ No regression dalam existing modules
- ✅ Performance acceptable (< 3s initial load)

### Documentation Updated

- ✅ Component documentation dengan JSDoc comments
- ✅ TypeScript types properly documented
- ✅ README updated untuk employee module
- ✅ User guide untuk HRD managers (optional)

## Risk Assessment

**Primary Risk:** Frontend-backend integration issues dengan API responses
**Mitigation:** Comprehensive TypeScript types matching API contracts, MSW mocks untuk testing
**Rollback Plan:** Remove employee routes, feature flag untuk gradual rollout

**Secondary Risk:** Performance issues dengan large employee datasets
**Mitigation:** Proper pagination, query optimization, code splitting, lazy loading
**Monitoring:** Browser performance profiling, Lighthouse scores

**UX Risk:** Complex forms overwhelming untuk users
**Mitigation:** Multi-step form atau clear section organization, inline help text
**Testing:** User testing dengan actual HRD managers

## Next Story Dependencies

This story completes the Employee Master Data Foundation Epic. Frontend implementation depends on:

- ✅ Story 1.2 Backend API (COMPLETED - prerequisite)

**Future Enhancements:**

- Story 1.4: Advanced Employee Search and Reporting (extends this frontend)
- Story 2.x: Career Path Management Frontend
- Story 3.x: Employee Performance Management

---

_This story was created using BMad create-next-story methodology on 2025-09-30 for KAEF HRIS Employee Master Data Epic 1.3._
